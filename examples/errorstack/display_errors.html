<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta name="robots" content="index,nofollow" />
<meta name="keywords" content"="HTML_Progress, PEAR_ErrorStack, API error, progress meter" />
<meta name="description" content="all API HTML_Progress errors are logs on STDOUT (browser)" />
<meta name="author" content="Laurent Laville" />
<title>PEAR::HTML::Progress example: ErrorStack on STDOUT</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" href="../examples.css" />
</head>
<body>

<a name="top">

<p><a href="../index.html"><img src="../images/home.gif" alt="Examples TOC"/>examples</a></p>

<h1><span class="chapter">Browser </span></h1>

<p align="right">$Date$</p>

<div class="toc">&nbsp;Table of contents </div>
<ul>
<li><a href="#intro">Introduction<a>
<li><a href="#output">Ouput</a>
<li><a href="#source">PHP source syntax highlight<a>
<li><a href="#run">Play demo<a>
</ul>


<a name="intro">
<h2><img src="../images/info.gif"/> Introduction</h2>
		
<p>This example requires :
<ul>
<li>PEAR::HTML_Progress 1.2.0RC3 or better.</li>
<li>PEAR::Log 1.8.0 or better.</li>
</ul>
</p>

<hr/>
<p><b>This example will show you how to customize errors logs renderer.</b></p>

<p>An error was volontary made on call of <b>setAnimSpeed()</b> method.
By default if you don't specify any logger, a <b>display</b> driver will be added with options below:
<ul>
<li>default context callback:  PEAR_ErrorStack::getFileLine()
<li>message callback: HTML_Progress::_msgCallback()
<li>error callback: HTML_Progress::_handleError()
</ul>

<p>To set any logger, it should be defined as an array and given as the last parameter
of HTML_Progress class constructor.</p>
<p>Array format :
<pre>
  array(
   'display_errors' = 'on' | 'off',
   'log_errors' = 'on' | 'off',
   'pushCallback' = valid callback for PEAR_ErrorStack,
   'msgCallback' = valid callback for PEAR_ErrorStack,
   'contextCallback' = valid callback for PEAR_ErrorStack 
   'handler' => array(
                  PEAR::Log driverName => array(
                    'name' => PEAR::Log driver name
                    'ident' => PEAR::Log driver identification string
                    'conf' => array( PEAR::Log driver configure options ),
                    'level' => PEAR::Log driver error level
                      ),
                  ...
  )
</pre>
</p>

<h3>display_errors</h3>
<p>
Print out errors (as a part of the output).  For production web sites,
you're strongly encouraged to turn this feature off, and use error logging
instead.  Keeping display_errors enabled on a production web site
may reveal security information to end users, such as file paths on your Web
server, your database schema or other information.
</p>

<h3>log_errors</h3>
<p>
Log errors into a log file (server-specific log, stderr, syslog ...)
As stated above, you're strongly advised to use error logging in place of
error displaying on production web sites.
</p>

<p>So, if you want to turn OFF all output errors, then you may write:</p>

<table class="hl-table" width="100%">
<tr>
<td class="hl-main" valign="top">
<span class="hl-inlinetags">&lt;?php </span><br/>
<span class="hl-reserved">require_once </span><span class="hl-quotes">'</span><span class="hl-string">HTML/Progress.php</span><span class="hl-quotes">'</span><span class="hl-code">;</span><br/>
<span class="hl-var">$logger</span><span class="hl-code"> = </span><span class="hl-reserved">array</span><span class="hl-brackets">()</span><span class="hl-code">;</span><br/>
<span class="hl-var">$logger</span><span class="hl-brackets">[</span><span class="hl-quotes">'</span><span class="hl-string">display_errors</span><span class="hl-quotes">'</span><span class="hl-brackets">]</span><span class="hl-code"> = </span><span class="hl-quotes">'</span><span class="hl-string">off</span><span class="hl-quotes">'</span><span class="hl-code">;     </span><span class="hl-comment">// turn off browser screen output</span><br/>
<span class="hl-var">$logger</span><span class="hl-brackets">[</span><span class="hl-quotes">'</span><span class="hl-string">log_errors</span><span class="hl-quotes">'</span><span class="hl-brackets">]</span><span class="hl-code"> = </span><span class="hl-quotes">'</span><span class="hl-string">off</span><span class="hl-quotes">'</span><span class="hl-code">;         </span><span class="hl-comment">// turn off all PEAR::Log drivers output</span><br/>
<span class="hl-var">$bar</span><span class="hl-code"> = </span><span class="hl-reserved">new </span><span class="hl-identifier">HTML_Progress</span><span class="hl-brackets">(</span><span class="hl-var">$logger</span><span class="hl-brackets">)</span><span class="hl-code">;</span><br/>
<span class="hl-inlinetags">?&gt;</span>
</td>
</tr>
</table>

<h3>LOG::display handlers</h3>
<p>
<b>I would have a PEAR_ErrorStack structure with context in bold face or any other render.</b>
<br/>
But the display driver in PEAR::Log 1.8.4 package can't allow it. So i've decided to make a patch.
Here are both versions :</p>
<ul>
<li><a target="_blank" href="../highlighter.php?file=errorstack/display184.php">Original</a> display handler.
<li><a target="_blank" href="../highlighter.php?file=errorstack/display2.php">My version</a> of display handler.
</ul>
</p>

<p>[<a href="#top">Top</a>]</p>


<a name="output">
<h2><img src="../images/image.gif"/>&nbsp;Output</h2>
<h3>Browser </h3>
<p><font size="1">
<b>Critical </b>: invalid input, parameter #1 "$delay" was expecting "integer", instead got "string"
<br/><font color="blue">
[class="html_progress" method="setanimspeed" file="E:\EasyPHP\php\PEAR\HTML\Progress.php" line="874"]
</font>
</font></p>

<p>[<a href="#top">Top</a>]</p>
		

<a name="source">
<h2><img src="../images/source.gif"/>&nbsp;PHP source syntax highlight</h2>
<a target="_blank" href="../highlighter.php?file=errorstack/display_errors.php">Open</a> source listing in a new window.

<p>[<a href="#top">Top</a>]</p>


<a name="run">
<h2><img src="../images/run.gif"/>&nbsp;Play demo</h2>
<p><a href="display_errors.php?push=0">Run</a> the script and die on exception.</p>
<p><a href="display_errors.php?push=1">Run</a> the script and catch exception.</p>

<p>[<a href="#top">Top</a>]</p>

</body>
</html>
